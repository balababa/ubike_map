{"remainingRequest":"/mnt/d/projects/ubike_map/node_modules/vue-loader/lib/index.js??vue-loader-options!/mnt/d/projects/ubike_map/src/App.vue?vue&type=style&index=0&lang=scss&","dependencies":[{"path":"/mnt/d/projects/ubike_map/src/App.vue","mtime":1591268774947},{"path":"/mnt/d/projects/ubike_map/node_modules/css-loader/dist/cjs.js","mtime":1589042647703},{"path":"/mnt/d/projects/ubike_map/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":1589185829207},{"path":"/mnt/d/projects/ubike_map/node_modules/postcss-loader/src/index.js","mtime":1585049201314},{"path":"/mnt/d/projects/ubike_map/node_modules/sass-loader/dist/cjs.js","mtime":1591177672536},{"path":"/mnt/d/projects/ubike_map/node_modules/cache-loader/dist/cjs.js","mtime":1591120007855},{"path":"/mnt/d/projects/ubike_map/node_modules/vue-loader/lib/index.js","mtime":1589185829207}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKQGltcG9ydCAnYm9vdHN0cmFwL3Njc3MvYm9vdHN0cmFwJzsKCiNtYXAgewogIGhlaWdodDogMTAwdmg7CiAgcG9zaXRpb246IHJlbGF0aXZlOwogIGJhY2tncm91bmQtY29sb3I6IGNvcmFsOwp9Cg=="},{"version":3,"sources":["App.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+GA;;AAEA;AACA;AACA;AACA;AACA","file":"App.vue","sourceRoot":"src","sourcesContent":["<template>\n  <div id=\"app\">\n    <div class=\"row no-gutters\">\n      <!-- 選擇地區 -->\n      <div class=\"toolbox col-sm-3 p-2 bg-white\">\n        <div class=\"form-group d-flex\">\n          <label for=\"city\" class=\"col-form-label mr-2 text-right\">縣市</label>\n          <div class=\"flex-fill\">\n            <select id=\"city\" class=\"form-control\" v-model=\"select.city\">\n              <!-- 製作下拉選單 -->\n              <option v-for=\"city in cities\" :key=\"city.name\" :value =\"city.name\">\n                {{ city.name }}\n              </option>\n            </select>\n          </div>\n        </div>\n        <div class=\"form-group d-flex\">\n          <label for=\"dist\" class=\"col-form-label mr-2 text-right\">地區</label>\n          <div class=\"flex-fill\">\n            <select id=\"dist\" class=\"form-control\" v-model=\"select.dist\">\n              <option v-for=\"district in districts\" :key=\"district.name\" :value=\"district.name\">\n                {{ district.name }}\n              </option>\n              <!-- 製作下拉選單 -->\n            </select>\n          </div>\n        </div>\n      </div>\n\n      <!-- 顯示地圖和 UBike 站點 -->\n      <div class=\"col-sm-9\">\n        <div id=\"map\"></div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport L from 'leaflet';\nimport taipeiCity from './assets/taipei_city.json';\n\nexport default {\n  name: 'App',\n  data: () => ({\n    select: {\n      city: '臺北市',\n      dist: taipeiCity[0].districts[0].name,\n    },\n    cities: taipeiCity,\n    retVal: [],\n    OSM: {},\n  }),\n  computed: {\n    districts() {\n      return this.cities.find((city) => city.name === this.select.city).districts;\n    },\n    youbikes() {\n      return this.retVal.filter((stop) => stop.sarea === this.select.dist);\n    },\n  },\n  watch: {\n    youbikes() {\n      this.updateMap();\n    },\n  },\n  methods: {\n    updateMap() {\n      this.OSM.eachLayer((layer) => {\n        if (layer instanceof L.Marker) {\n          this.OSM.removeLayer(layer);\n        }\n      });\n\n      this.youbikes.forEach((bike) => {\n        L.marker([bike.lat, bike.lng])\n          .bindPopup(`<p><strong style=\"font-size: 20px;\">${bike.sna}</strong></p>\n        <strong style=\"font-size: 16px; color: #d45345;\">可租借車輛剩餘：${bike.sbi} 台</strong><br>\n        可停空位剩餘: ${bike.bemp}<br>\n        <small>最後更新時間: ${bike.mday}</small>`)\n          .addTo(this.OSM);\n      });\n\n      this.cities[0].districts.forEach((dist) => {\n        if (dist.name === this.select.dist) {\n          this.OSM.panTo(L.latLng(dist.latitude, dist.longitude));\n        }\n      });\n    },\n  },\n  created() {\n    const api = 'https://tcgbusfs.blob.core.windows.net/blobyoubike/YouBikeTP.json';\n    this.$http.get(api).then((response) => {\n      this.retVal = Object.values(response.data.retVal);\n    });\n  },\n  mounted() {\n    this.OSM = L.map('map', {\n      center: [25.044214, 121.524725],\n      zoom: 18,\n    });\n\n    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {\n      attribution: 'Map data &copy; <a href=\"https://www.openstreetmap.org/\">OpenStreetMap</a> contributors, <a href=\"https://creativecommons.org/licenses/by-sa/2.0/\">CC-BY-SA</a>, Imagery © <a href=\"https://www.mapbox.com/\">Mapbox</a>',\n      maxZoom: 18,\n    }).addTo(this.OSM);\n  },\n};\n\n</script>\n\n<style lang=\"scss\">\n@import 'bootstrap/scss/bootstrap';\n\n#map {\n  height: 100vh;\n  position: relative;\n  background-color: coral;\n}\n</style>\n"]}]}