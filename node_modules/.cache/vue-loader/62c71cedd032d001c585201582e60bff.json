{"remainingRequest":"/mnt/d/projects/ubike_map/node_modules/vue-loader/lib/index.js??vue-loader-options!/mnt/d/projects/ubike_map/src/App.vue?vue&type=script&lang=js&","dependencies":[{"path":"/mnt/d/projects/ubike_map/src/App.vue","mtime":1591268774947},{"path":"/mnt/d/projects/ubike_map/node_modules/cache-loader/dist/cjs.js","mtime":1591120007855},{"path":"/mnt/d/projects/ubike_map/node_modules/babel-loader/lib/index.js","mtime":1585049200444},{"path":"/mnt/d/projects/ubike_map/node_modules/cache-loader/dist/cjs.js","mtime":1591120007855},{"path":"/mnt/d/projects/ubike_map/node_modules/vue-loader/lib/index.js","mtime":1589185829207}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBMIGZyb20gJ2xlYWZsZXQnOwppbXBvcnQgdGFpcGVpQ2l0eSBmcm9tICcuL2Fzc2V0cy90YWlwZWlfY2l0eS5qc29uJzsKCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAnQXBwJywKICBkYXRhOiAoKSA9PiAoewogICAgc2VsZWN0OiB7CiAgICAgIGNpdHk6ICfoh7rljJfluIInLAogICAgICBkaXN0OiB0YWlwZWlDaXR5WzBdLmRpc3RyaWN0c1swXS5uYW1lLAogICAgfSwKICAgIGNpdGllczogdGFpcGVpQ2l0eSwKICAgIHJldFZhbDogW10sCiAgICBPU006IHt9LAogIH0pLAogIGNvbXB1dGVkOiB7CiAgICBkaXN0cmljdHMoKSB7CiAgICAgIHJldHVybiB0aGlzLmNpdGllcy5maW5kKChjaXR5KSA9PiBjaXR5Lm5hbWUgPT09IHRoaXMuc2VsZWN0LmNpdHkpLmRpc3RyaWN0czsKICAgIH0sCiAgICB5b3ViaWtlcygpIHsKICAgICAgcmV0dXJuIHRoaXMucmV0VmFsLmZpbHRlcigoc3RvcCkgPT4gc3RvcC5zYXJlYSA9PT0gdGhpcy5zZWxlY3QuZGlzdCk7CiAgICB9LAogIH0sCiAgd2F0Y2g6IHsKICAgIHlvdWJpa2VzKCkgewogICAgICB0aGlzLnVwZGF0ZU1hcCgpOwogICAgfSwKICB9LAogIG1ldGhvZHM6IHsKICAgIHVwZGF0ZU1hcCgpIHsKICAgICAgdGhpcy5PU00uZWFjaExheWVyKChsYXllcikgPT4gewogICAgICAgIGlmIChsYXllciBpbnN0YW5jZW9mIEwuTWFya2VyKSB7CiAgICAgICAgICB0aGlzLk9TTS5yZW1vdmVMYXllcihsYXllcik7CiAgICAgICAgfQogICAgICB9KTsKCiAgICAgIHRoaXMueW91YmlrZXMuZm9yRWFjaCgoYmlrZSkgPT4gewogICAgICAgIEwubWFya2VyKFtiaWtlLmxhdCwgYmlrZS5sbmddKQogICAgICAgICAgLmJpbmRQb3B1cChgPHA+PHN0cm9uZyBzdHlsZT0iZm9udC1zaXplOiAyMHB4OyI+JHtiaWtlLnNuYX08L3N0cm9uZz48L3A+CiAgICAgICAgPHN0cm9uZyBzdHlsZT0iZm9udC1zaXplOiAxNnB4OyBjb2xvcjogI2Q0NTM0NTsiPuWPr+enn+WAn+i7iui8m+WJqemkmO+8miR7YmlrZS5zYml9IOWPsDwvc3Ryb25nPjxicj4KICAgICAgICDlj6/lgZznqbrkvY3lianppJg6ICR7YmlrZS5iZW1wfTxicj4KICAgICAgICA8c21hbGw+5pyA5b6M5pu05paw5pmC6ZaTOiAke2Jpa2UubWRheX08L3NtYWxsPmApCiAgICAgICAgICAuYWRkVG8odGhpcy5PU00pOwogICAgICB9KTsKCiAgICAgIHRoaXMuY2l0aWVzWzBdLmRpc3RyaWN0cy5mb3JFYWNoKChkaXN0KSA9PiB7CiAgICAgICAgaWYgKGRpc3QubmFtZSA9PT0gdGhpcy5zZWxlY3QuZGlzdCkgewogICAgICAgICAgdGhpcy5PU00ucGFuVG8oTC5sYXRMbmcoZGlzdC5sYXRpdHVkZSwgZGlzdC5sb25naXR1ZGUpKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfSwKICB9LAogIGNyZWF0ZWQoKSB7CiAgICBjb25zdCBhcGkgPSAnaHR0cHM6Ly90Y2didXNmcy5ibG9iLmNvcmUud2luZG93cy5uZXQvYmxvYnlvdWJpa2UvWW91QmlrZVRQLmpzb24nOwogICAgdGhpcy4kaHR0cC5nZXQoYXBpKS50aGVuKChyZXNwb25zZSkgPT4gewogICAgICB0aGlzLnJldFZhbCA9IE9iamVjdC52YWx1ZXMocmVzcG9uc2UuZGF0YS5yZXRWYWwpOwogICAgfSk7CiAgfSwKICBtb3VudGVkKCkgewogICAgdGhpcy5PU00gPSBMLm1hcCgnbWFwJywgewogICAgICBjZW50ZXI6IFsyNS4wNDQyMTQsIDEyMS41MjQ3MjVdLAogICAgICB6b29tOiAxOCwKICAgIH0pOwoKICAgIEwudGlsZUxheWVyKCdodHRwczovL3tzfS50aWxlLm9wZW5zdHJlZXRtYXAub3JnL3t6fS97eH0ve3l9LnBuZycsIHsKICAgICAgYXR0cmlidXRpb246ICdNYXAgZGF0YSAmY29weTsgPGEgaHJlZj0iaHR0cHM6Ly93d3cub3BlbnN0cmVldG1hcC5vcmcvIj5PcGVuU3RyZWV0TWFwPC9hPiBjb250cmlidXRvcnMsIDxhIGhyZWY9Imh0dHBzOi8vY3JlYXRpdmVjb21tb25zLm9yZy9saWNlbnNlcy9ieS1zYS8yLjAvIj5DQy1CWS1TQTwvYT4sIEltYWdlcnkgwqkgPGEgaHJlZj0iaHR0cHM6Ly93d3cubWFwYm94LmNvbS8iPk1hcGJveDwvYT4nLAogICAgICBtYXhab29tOiAxOCwKICAgIH0pLmFkZFRvKHRoaXMuT1NNKTsKICB9LAp9OwoK"},{"version":3,"sources":["App.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsCA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA","file":"App.vue","sourceRoot":"src","sourcesContent":["<template>\n  <div id=\"app\">\n    <div class=\"row no-gutters\">\n      <!-- 選擇地區 -->\n      <div class=\"toolbox col-sm-3 p-2 bg-white\">\n        <div class=\"form-group d-flex\">\n          <label for=\"city\" class=\"col-form-label mr-2 text-right\">縣市</label>\n          <div class=\"flex-fill\">\n            <select id=\"city\" class=\"form-control\" v-model=\"select.city\">\n              <!-- 製作下拉選單 -->\n              <option v-for=\"city in cities\" :key=\"city.name\" :value =\"city.name\">\n                {{ city.name }}\n              </option>\n            </select>\n          </div>\n        </div>\n        <div class=\"form-group d-flex\">\n          <label for=\"dist\" class=\"col-form-label mr-2 text-right\">地區</label>\n          <div class=\"flex-fill\">\n            <select id=\"dist\" class=\"form-control\" v-model=\"select.dist\">\n              <option v-for=\"district in districts\" :key=\"district.name\" :value=\"district.name\">\n                {{ district.name }}\n              </option>\n              <!-- 製作下拉選單 -->\n            </select>\n          </div>\n        </div>\n      </div>\n\n      <!-- 顯示地圖和 UBike 站點 -->\n      <div class=\"col-sm-9\">\n        <div id=\"map\"></div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport L from 'leaflet';\nimport taipeiCity from './assets/taipei_city.json';\n\nexport default {\n  name: 'App',\n  data: () => ({\n    select: {\n      city: '臺北市',\n      dist: taipeiCity[0].districts[0].name,\n    },\n    cities: taipeiCity,\n    retVal: [],\n    OSM: {},\n  }),\n  computed: {\n    districts() {\n      return this.cities.find((city) => city.name === this.select.city).districts;\n    },\n    youbikes() {\n      return this.retVal.filter((stop) => stop.sarea === this.select.dist);\n    },\n  },\n  watch: {\n    youbikes() {\n      this.updateMap();\n    },\n  },\n  methods: {\n    updateMap() {\n      this.OSM.eachLayer((layer) => {\n        if (layer instanceof L.Marker) {\n          this.OSM.removeLayer(layer);\n        }\n      });\n\n      this.youbikes.forEach((bike) => {\n        L.marker([bike.lat, bike.lng])\n          .bindPopup(`<p><strong style=\"font-size: 20px;\">${bike.sna}</strong></p>\n        <strong style=\"font-size: 16px; color: #d45345;\">可租借車輛剩餘：${bike.sbi} 台</strong><br>\n        可停空位剩餘: ${bike.bemp}<br>\n        <small>最後更新時間: ${bike.mday}</small>`)\n          .addTo(this.OSM);\n      });\n\n      this.cities[0].districts.forEach((dist) => {\n        if (dist.name === this.select.dist) {\n          this.OSM.panTo(L.latLng(dist.latitude, dist.longitude));\n        }\n      });\n    },\n  },\n  created() {\n    const api = 'https://tcgbusfs.blob.core.windows.net/blobyoubike/YouBikeTP.json';\n    this.$http.get(api).then((response) => {\n      this.retVal = Object.values(response.data.retVal);\n    });\n  },\n  mounted() {\n    this.OSM = L.map('map', {\n      center: [25.044214, 121.524725],\n      zoom: 18,\n    });\n\n    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {\n      attribution: 'Map data &copy; <a href=\"https://www.openstreetmap.org/\">OpenStreetMap</a> contributors, <a href=\"https://creativecommons.org/licenses/by-sa/2.0/\">CC-BY-SA</a>, Imagery © <a href=\"https://www.mapbox.com/\">Mapbox</a>',\n      maxZoom: 18,\n    }).addTo(this.OSM);\n  },\n};\n\n</script>\n\n<style lang=\"scss\">\n@import 'bootstrap/scss/bootstrap';\n\n#map {\n  height: 100vh;\n  position: relative;\n  background-color: coral;\n}\n</style>\n"]}]}